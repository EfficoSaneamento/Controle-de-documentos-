<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Documentos RH Digital</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
  <style>
    body {
      margin:0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg,#2980b9,#8e44ad);
      display:flex;
      justify-content:center;
      padding: 30px 0;
      color:#fff;
    }
    .container {
      background:#fff;
      color:#2c3e50;
      border-radius:16px;
      padding:25px;
      width:90%;
      max-width:600px;
      box-shadow:0 10px 25px rgba(0,0,0,0.2);
      animation:fadeIn 0.7s ease-in-out;
    }
    @keyframes fadeIn {
      from {opacity:0; transform:translateY(20px);}
      to {opacity:1; transform:translateY(0);}
    }
    h1 {
      text-align:center;
      margin-bottom:20px;
      color:#2980b9;
    }
    .doc-item {
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:15px;
    }
    .doc-item label {
      flex:1;
      cursor:pointer;
    }
    .doc-item input[type=file] {
      display:none;
    }
    .btn-camera, .btn-upload {
      border:none;
      background:#2980b9;
      color:#fff;
      border-radius:8px;
      padding:8px 10px;
      cursor:pointer;
      margin-left:5px;
      font-size:14px;
      display:flex;
      align-items:center;
    }
    .btn-camera:hover, .btn-upload:hover {
      background:#3498db;
    }
    .status {
      text-align:center;
      font-weight:bold;
      margin-top:10px;
      min-height:20px;
    }
    video {
      width:100%;
      border-radius:12px;
      margin-top:10px;
      border:2px solid #2980b9;
      display:none;
    }
    canvas {
      display:none;
    }
    button.send-btn {
      width:100%;
      background:#27ae60;
      color:#fff;
      padding:14px;
      border:none;
      border-radius:10px;
      font-size:16px;
      cursor:pointer;
      margin-top:15px;
    }
    button.send-btn:hover {
      background:#2ecc71;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1><i class="fas fa-folder-open"></i> Documentos RH</h1>

    <form id="formDocumentos">
      <!-- Exemplo de item -->
      <div class="doc-item">
        <label>Foto Selfie (Para criação do crachá)</label>
        <div>
          <button type="button" class="btn-camera" onclick="abrirCamera('selfie')"><i class="fas fa-camera"></i></button>
          <label class="btn-upload"><i class="fas fa-upload"></i>
            <input type="file" accept="image/*" onchange="uploadArquivo(event,'selfie')">
          </label>
        </div>
      </div>

      <div class="doc-item">
        <label>CTPS (Em caso de não possuir a digital)</label>
        <div>
          <button type="button" class="btn-camera" onclick="abrirCamera('ctps')"><i class="fas fa-camera"></i></button>
          <label class="btn-upload"><i class="fas fa-upload"></i>
            <input type="file" accept="image/*,application/pdf" onchange="uploadArquivo(event,'ctps')">
          </label>
        </div>
      </div>

      <!-- Repetir para os demais campos -->
      <div class="doc-item">
        <label>Cópia do CPF</label>
        <div>
          <button type="button" class="btn-camera" onclick="abrirCamera('cpf')"><i class="fas fa-camera"></i></button>
          <label class="btn-upload"><i class="fas fa-upload"></i>
            <input type="file" accept="image/*,application/pdf" onchange="uploadArquivo(event,'cpf')">
          </label>
        </div>
      </div>

      <div class="doc-item">
        <label>Cópia do RG</label>
        <div>
          <button type="button" class="btn-camera" onclick="abrirCamera('rg')"><i class="fas fa-camera"></i></button>
          <label class="btn-upload"><i class="fas fa-upload"></i>
            <input type="file" accept="image/*,application/pdf" onchange="uploadArquivo(event,'rg')">
          </label>
        </div>
      </div>

      <!-- Adicionar todos os demais itens da sua lista aqui da mesma forma -->

      <button type="button" class="send-btn" onclick="enviarDocumentos()">Enviar Tudo</button>
      <div class="status" id="status"></div>
    </form>

    <video id="videoCamera"></video>
    <canvas id="canvasCamera"></canvas>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.1.1/dist/tesseract.min.js"></script>
  <script>
    const arquivos = {}; // Vai armazenar base64 ou arquivos

    function abrirCamera(tipo){
      const video = document.getElementById('videoCamera');
      const canvas = document.getElementById('canvasCamera');
      video.style.display = 'block';
      navigator.mediaDevices.getUserMedia({video:true})
        .then(stream => {
          video.srcObject = stream;
          video.play();
          // captura após 2 segundos (exemplo)
          setTimeout(()=>{
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            canvas.getContext('2d').drawImage(video,0,0);
            arquivos[tipo] = canvas.toDataURL('image/jpeg');
            document.getElementById('status').innerText = tipo + " capturado via câmera!";
            video.style.display = 'none';
            stream.getTracks().forEach(track=>track.stop());
          },2000);
        });
    }

    function uploadArquivo(event,tipo){
      const file = event.target.files[0];
      const reader = new FileReader();
      reader.onload = ()=> {
        arquivos[tipo] = reader.result;
        document.getElementById('status').innerText = tipo + " carregado via upload!";
      };
      reader.readAsDataURL(file);
    }

    async function enviarDocumentos(){
      if(Object.keys(arquivos).length === 0){
        alert("Nenhum documento foi carregado!");
        return;
      }
      document.getElementById('status').innerText = "Enviando documentos...";
      try{
        await fetch("URL_DO_WEBHOOK_DO_POWER_AUTOMATE",{
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body:JSON.stringify(arquivos)
        });
        document.getElementById('status').innerText = "Todos os documentos enviados!";
      }catch(e){
        console.error(e);
        document.getElementById('status').innerText = "Erro ao enviar!";
      }
    }
  </script>
</body>
</html>
